{% extends "base.html" %}
{% block title %}Student Â· Intelligent Timetable{% endblock %}

{% block content %}

<div class="section-header">
    <h2>Student Dashboard</h2>
    <span>
        {% if batch %}
            Weekly schedule for {{ batch.name }}
        {% else %}
            Weekly schedule
        {% endif %}
    </span>
</div>

<div class="row g-4">
    <div class="col-md-12">
        <div class="mb-2">
            <div class="text-muted-soft">
                Course Name <span class="tt-course">Sample</span>
                &nbsp; Room Name <span class="tt-room">Sample</span>
                &nbsp; Faculty Name <span class="tt-faculty">Sample</span>
                &nbsp; Section / Batch <span class="tt-section">Sample</span>
            </div>
        </div>

        <div class="card mb-3">
            <div class="card-body">
                <h5 class="card-title">Your Timetable</h5>
                <p class="text-muted-soft mb-2">
                    Generated from the latest timetable. Empty slots show "No Class".
                </p>

                {% if days and periods %}
                <div class="timetable-wrapper">
                    <table class="timetable-table">
                        <thead>
                            <tr>
                                <th>Day / Time</th>
                                {% for start, end in periods %}
                                    <th>
                                        <div class="period-number">
                                            {{ loop.index }}
                                        </div>
                                        <div class="time-range">
                                            {{ start.strftime('%H:%M') }}<br>
                                            - {{ end.strftime('%H:%M') }}
                                        </div>
                                    </th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for day_index, day_label in days %}
                            <tr>
                                <td class="day-label">{{ day_label }}</td>

                                {% for p_idx in range(periods|length) %}
                                    {% set entry = grid.get((day_index, p_idx)) %}
                                    <td class="tt-cell">
                                        {% if entry %}
                                            <div class="tt-course">
                                                {{ entry.subject.code }} {{ entry.subject.name }}
                                            </div>
                                            <div class="tt-room">
                                                {{ entry.room.name }}
                                            </div>
                                            <div class="tt-faculty">
                                                {{ entry.faculty.name }}
                                            </div>
                                            <div class="tt-section">
                                                {{ entry.batch.name }}
                                            </div>
                                        {% else %}
                                            <div class="tt-empty">No Class</div>
                                        {% endif %}
                                    </td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                    <p class="text-muted-soft mb-0">
                        {% if not batch %}
                            Your batch is not linked to your account yet. Ask the admin to set it.
                        {% else %}
                            No timetable generated yet for your batch.
                        {% endif %}
                    </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock %}